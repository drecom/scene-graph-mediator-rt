{"version":3,"sources":["webpack://pixi-scene-graph/webpack/universalModuleDefinition","webpack://pixi-scene-graph/webpack/bootstrap","webpack://pixi-scene-graph/./src/Level.ts","webpack://pixi-scene-graph/./src/Type.ts","webpack://pixi-scene-graph/./src/converter/IntermediateDto.ts","webpack://pixi-scene-graph/./src/converter/TextTree.ts","webpack://pixi-scene-graph/./src/index.ts","webpack://pixi-scene-graph/./src/runtime_mediator/Pixi.ts","webpack://pixi-scene-graph/./src/runtime_mediator/RuntimeMediator.ts"],"names":[],"mappings":"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","file":"pixi-scene-graph.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pixi-scene-graph\"] = factory();\n\telse\n\t\troot[\"pixi-scene-graph\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","/**\n * Scene graph expression level.<br />\n * All converter must support these levels.\n */\nconst Level: {\n  SUMMARY: number,\n  DETAIL: number\n} = Object.freeze({\n  SUMMARY: 1,\n  DETAIL: 2\n});\n\nexport default Level;\n","/**\n * Scene graph expression variants.<br />\n * TODO: accept user extension.\n */\nconst Type: {\n  INTERMEDIATE_DTO: string,\n  TEXT_TREE: string\n} = Object.freeze({\n  INTERMEDIATE_DTO: 'INTERMEDIATE_DTO',\n  TEXT_TREE:        'TEXT_TREE'\n});\n\nexport default Type;\n","import IntermediateDtoSchema from 'interfaces/IntermediateDtoSchema';\nimport Converter from 'interfaces/Converter';\nimport Level from 'Level';\n\n/**\n * Converter implementation for IntermediateDto\n */\nexport default class IntermediateDto implements Converter<IntermediateDtoSchema> {\n\n  private graph!: IntermediateDtoSchema;\n\n  constructor(graph: IntermediateDtoSchema) {\n    this.graph = graph;\n  }\n\n  public convert(level: number, depth?: boolean[], graph?: IntermediateDtoSchema)\n    : IntermediateDtoSchema | null {\n    let result = null;\n    switch (level) {\n      case Level.SUMMARY: {\n        result = this.convertAsSummary(depth, graph);\n        break;\n      }\n      case Level.DETAIL: {\n        result = this.convertAsDetail(depth, graph);\n        break;\n      }\n      default: break;\n    }\n\n    return result;\n  }\n\n  public convertAsSummary(depth?: boolean[], graph?: IntermediateDtoSchema): IntermediateDtoSchema {\n    const baseGraph = graph || this.graph;\n    const baseDepth = depth || [];\n\n    // Following lines do the same process as just returning graph.\n    // IntermediateDtoSchema is expected to have more properties in the future.\n    // leave these lines to virtualy shrinking IntermediateDtoSchema properties.\n\n    const summary: IntermediateDtoSchema = {\n      constructorClass: baseGraph.constructorClass,\n      name:             baseGraph.name,\n      children:         baseGraph.children,\n      properties:       baseGraph.properties\n    };\n\n    for (let i = 0; i < summary.children.length; i++) {\n      summary.children[i] = this.convertAsSummary(baseDepth, summary.children[i]);\n    }\n\n    return summary;\n  }\n\n  public convertAsDetail(_depth?: boolean[], graph?: IntermediateDtoSchema): IntermediateDtoSchema {\n    return graph || this.graph;\n  }\n}\n","import IntermediateDtoSchema from 'interfaces/IntermediateDtoSchema';\nimport Converter from 'interfaces/Converter';\nimport Level from 'Level';\n\nexport default class TextTree implements Converter<string> {\n\n  private graph!: IntermediateDtoSchema;\n\n  constructor(graph: IntermediateDtoSchema) {\n    this.graph = graph;\n  }\n\n  public convert(level: number, depth?: boolean[], graph?: IntermediateDtoSchema): string | null {\n    let result = null;\n    switch (level) {\n      case Level.SUMMARY: {\n        result = this.convertAsSummary(depth, graph);\n        break;\n      }\n      case Level.DETAIL: {\n        result = this.convertAsDetail(depth, graph);\n        break;\n      }\n      default: break;\n    }\n\n    return result;\n  }\n\n  public convertAsSummary(depth?: boolean[], graph?: IntermediateDtoSchema): string {\n    const baseGraph = graph || this.graph;\n    const baseDepth = depth || [];\n\n    let out = '';\n    out += this.convertAsSummaryLine(baseDepth, baseGraph);\n\n    baseDepth.push(true);\n    for (let i = 0; i < baseGraph.children.length; i++) {\n      baseDepth[baseDepth.length - 1] = (i < (baseGraph.children.length - 1));\n      out += this.convertAsSummary(baseDepth, baseGraph.children[i]);\n    }\n    baseDepth.pop();\n\n    return out;\n  }\n\n  public convertAsDetail(_depth?: boolean[], _graph?: IntermediateDtoSchema): string {\n    // not supported\n    return '';\n  }\n\n  private convertAsSummaryLine(depth: boolean[], graph: IntermediateDtoSchema): string {\n    let dest = '';\n\n    for (let i = 0; i < depth.length; i++) {\n      dest += '  ';\n      dest += (depth[i]) ? '|' : ' ';\n    }\n\n    dest += `- ${graph.name || ''}(${graph.constructorClass.name})\\n`;\n    return dest;\n  }\n}\n","import RuntimeMediator from 'runtime_mediator/RuntimeMediator';\nimport Pixi from 'runtime_mediator/Pixi';\n\nimport Level from 'Level';\nimport Type from 'Type';\n\n/**\n * SceneGraph provides runtime node mediator.<br />\n * It is not frozen and should be extended.\n */\nconst SceneGraph: {\n  Pixi: typeof RuntimeMediator\n} = {\n  Pixi\n};\n\nconst SceneGraphOptions: {\n  Level: typeof Level,\n  Type: typeof Type\n} = {\n  Level,\n  Type\n};\n\nexport { SceneGraph, SceneGraphOptions, RuntimeMediator };\n","import { Container } from 'pixi.js';\nimport IntermediateDtoSchema from 'interfaces/IntermediateDtoSchema';\nimport RuntimeMediator from 'runtime_mediator/RuntimeMediator';\n\n/**\n * Pixi implementation of RuntimeMediator\n */\nexport default class Pixi extends RuntimeMediator {\n  /**\n   * Initiators should not be an instance property.\n   */\n  public static Initiators: { [key: string]: Function } = {\n    // Text requires constructor arguments.\n    Text: (Klass: any, properties: { [key: string]: any }) => {\n      return new Klass(properties._text, properties._style);\n    }\n  };\n\n  /**\n   * Returns singleton Pixi.Initiators to allow user modification.\n   */\n  public getInitiators(): { [key: string]: Function } {\n    return Pixi.Initiators;\n  }\n\n  public createSchema(base: any): IntermediateDtoSchema {\n    const dto: IntermediateDtoSchema = {\n      constructorClass: (base as Container).constructor,\n      name:             (base as Container).name,\n      children:         [],\n      properties:       {}\n    };\n\n    // Iterate with for..in to crawl all properties includes prototype\n    for (const key in base) {\n      // TODO: Is function neccesary ?\n      // Scene graph has responsibility to store and restore scene structure,\n      // but not to runtime object.\n      dto.properties[key] = base[key];\n    }\n\n    return dto;\n  }\n\n  public createSchemaRecursive(node: any): IntermediateDtoSchema {\n    const schema = this.createSchema(node);\n\n    if (node.children) {\n      for (let i = 0; i < node.children.length; i++) {\n        const child = this.createSchemaRecursive(node.children[i]);\n        // use scene graph system for children\n        child.children = [];\n\n        schema.children.push(child);\n      }\n    }\n\n    return schema;\n  }\n\n  /**\n   * TODO: When importing the objects that exported from the scene graph\n   * built from manipulated script, it may have problems below.<br />\n   * <br />\n   * 1. There is no way to know the proper constructor params.<br />\n   *    this causes error when cpnstructor validates the arguments.<br />\n   *    This problem is currently solved by defining initiators.<br />\n   * 2. Exporter can not identify the node(s) added in constructor.<br />\n   *    It causes duplicate instantiation.\n   */\n  public import(dto: IntermediateDtoSchema): any {\n    // TODO: are constructor arguments neccesary ?\n    let entity;\n    const Klass = dto.constructorClass;\n\n    if (Pixi.Initiators.hasOwnProperty(Klass.name)) {\n      entity = Pixi.Initiators[Klass.name](Klass, dto.properties as any);\n    } else {\n      entity = new dto.constructorClass();\n    }\n\n    entity.name = dto.name;\n\n    const properties = Object.keys(dto.properties);\n    for (let j = 0; j < properties.length; j++) {\n      const property = properties[j];\n\n      // use scene graph system for children\n      if (property === 'children') {\n        continue;\n      }\n\n      try {\n        entity[property] = dto.properties[property];\n      } catch (e) {\n        // TODO: Identify error caused by accessor\n        // Other error can not be passed\n        console.log(e);\n      }\n    }\n\n    if (!entity) {\n      throw new Error(\n        'Restoring runtime object failed. ' +\n        `Could not instantiate '${dto.constructorClass.name}'`\n      );\n    }\n\n    for (let j = 0; j < dto.children.length; j++) {\n      entity.addChild(this.import(dto.children[j]));\n    }\n\n    return entity;\n  }\n}\n","import Level from 'Level';\nimport Type from 'Type';\nimport IntermediateDtoSchema from 'interfaces/IntermediateDtoSchema';\nimport TextTree from 'converter/TextTree';\nimport IntermediateDto from 'converter/IntermediateDto';\n\n/**\n * Abstract class for runtime mediation.<br />\n * It handles runtime object like Unity's GameObject or Cocos's Node\n */\nexport default abstract class RuntimeMediator {\n  /**\n   * Returns initiate methods related to class name.<br />\n   * Often it is used to define initiation of a class instance\n   * with constructor that has argument.<br />\n   * Initiators are defined in each runtime implementation and it should be augmented by user.<br />\n   * Remarks: This is an experimental design and may be changed in the future.\n   */\n  abstract getInitiators(): { [key: string]: Function };\n  /**\n   * Create IntermediateDtoSchema from base node.\n   */\n  abstract createSchema(base: any): IntermediateDtoSchema;\n  /**\n   * Create IntermediateDtoSchema from base node recursively.\n   */\n  abstract createSchemaRecursive(node: any): IntermediateDtoSchema;\n\n  /**\n   * Import IntermediateDtoSchema and rebuild runtime node structure.\n   */\n  abstract import(dto: IntermediateDtoSchema): any;\n\n  /**\n   * Export current runtime node structure to desired format\n   * like text tree or raw intermediates.<br />\n   * FIXME: Child node(s) added in constructor may duplicate.\n   */\n  public export(type: string, rootNode: any, convertLevel: number = Level.SUMMARY): any {\n    const schema = this.createSchemaRecursive(rootNode);\n\n    if (!schema) {\n      return null;\n    }\n\n    let converter = null;\n\n    switch (type) {\n      case Type.TEXT_TREE:        converter = new TextTree(schema); break;\n      case Type.INTERMEDIATE_DTO: converter = new IntermediateDto(schema); break;\n      default: break;\n    }\n\n    if (!converter) {\n      return null;\n    }\n\n    return converter.convert(convertLevel);\n  }\n}\n"],"sourceRoot":""}